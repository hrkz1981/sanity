<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ラクマ商品管理 - Premium Bags</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen py-8">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- ヘッダー -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900">ラクマ商品管理システム</h1>
                <p class="mt-2 text-gray-600">商品情報を入力してサイトに追加</p>
            </div>

            <!-- 商品追加フォーム -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">新しい商品を追加</h2>
                <form id="productForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ラクマ商品URL *</label>
                            <input type="url" id="rakumaUrl" required 
                                   placeholder="https://item.fril.jp/..."
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">商品名 *</label>
                            <input type="text" id="title" required 
                                   placeholder="商品名を入力"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">価格（円）*</label>
                            <input type="number" id="price" required 
                                   placeholder="15000"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">定価（円）</label>
                            <input type="number" id="originalPrice" 
                                   placeholder="25000"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ブランド</label>
                            <input type="text" id="brand" 
                                   placeholder="LOUIS VUITTON"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">商品の状態 *</label>
                            <select id="condition" required 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <option value="">選択してください</option>
                                <option value="new">新品・未使用</option>
                                <option value="like-new">未使用に近い</option>
                                <option value="good">目立った傷や汚れなし</option>
                                <option value="fair">やや傷や汚れあり</option>
                                <option value="poor">傷や汚れあり</option>
                                <option value="bad">全体的に状態が悪い</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">カテゴリー *</label>
                            <select id="category" required 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <option value="">選択してください</option>
                                <option value="handbag">ハンドバッグ</option>
                                <option value="shoulder">ショルダーバッグ</option>
                                <option value="tote">トートバッグ</option>
                                <option value="backpack">リュック・バックパック</option>
                                <option value="clutch">クラッチバッグ</option>
                                <option value="boston">ボストンバッグ</option>
                                <option value="other">その他</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">画像URL</label>
                            <input type="url" id="imageUrl" 
                                   placeholder="https://..."
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">商品説明</label>
                        <textarea id="description" rows="3" 
                                  placeholder="商品の詳細説明"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"></textarea>
                    </div>

                    <div class="flex items-center space-x-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="featured" class="mr-2">
                            <span class="text-sm text-gray-700">おすすめ商品にする</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="isAvailable" checked class="mr-2">
                            <span class="text-sm text-gray-700">販売中</span>
                        </label>
                    </div>

                    <button type="submit" 
                            class="w-full bg-purple-600 text-white px-4 py-3 rounded-md hover:bg-purple-700 font-bold">
                        🛍️ 商品をサイトに追加
                    </button>
                </form>
            </div>

            <!-- 生成されたコード表示エリア -->
            <div id="generatedCode" class="bg-white rounded-lg shadow-md p-6 hidden">
                <h3 class="text-lg font-semibold mb-4">生成されたコード</h3>
                <p class="text-sm text-gray-600 mb-4">
                    以下のコードを <code>src/lib/mockData.ts</code> の products 配列に追加してください：
                </p>
                <pre id="codeOutput" class="bg-gray-100 p-4 rounded-md text-sm overflow-x-auto"></pre>
                <button onclick="copyCode()" 
                        class="mt-4 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">
                    📋 コピー
                </button>
            </div>

            <!-- 既存商品一覧 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">サイトに掲載中の商品</h3>
                <div id="existingProducts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- 既存商品がここに表示される -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // フォーム送信処理
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                title: document.getElementById('title').value,
                rakumaUrl: document.getElementById('rakumaUrl').value,
                price: parseInt(document.getElementById('price').value) || 0,
                originalPrice: parseInt(document.getElementById('originalPrice').value) || null,
                brand: document.getElementById('brand').value || '',
                condition: document.getElementById('condition').value,
                category: document.getElementById('category').value,
                imageUrl: document.getElementById('imageUrl').value || 'https://via.placeholder.com/400x400/6366F1/FFFFFF?text=商品画像',
                description: document.getElementById('description').value || '',
                featured: document.getElementById('featured').checked,
                isAvailable: document.getElementById('isAvailable').checked
            };

            generateProductCode(formData);
        });

        // 商品コード生成
        function generateProductCode(data) {
            const slug = data.title
                .toLowerCase()
                .replace(/[^a-zA-Z0-9\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/g, '-')
                .replace(/-+/g, '-')
                .replace(/^-|-$/g, '')
                .substring(0, 96);

            const productId = 'product' + Date.now();

            const code = `  {
    _id: '${productId}',
    title: '${data.title}',
    slug: { current: '${slug}' },
    mainImage: {
      asset: {
        _id: 'img${Date.now()}',
        url: '${data.imageUrl}'
      },
      alt: '${data.title}'
    },
    price: ${data.price},${data.originalPrice ? `
    originalPrice: ${data.originalPrice},` : ''}
    brand: '${data.brand}',
    condition: '${data.condition}',
    isAvailable: ${data.isAvailable},
    featured: ${data.featured},
    category: '${data.category}',
    rakumaUrl: '${data.rakumaUrl}'${data.description ? `,
    description: '${data.description}'` : ''}
  },`;

            document.getElementById('codeOutput').textContent = code;
            document.getElementById('generatedCode').classList.remove('hidden');
            
            // フォームリセット
            document.getElementById('productForm').reset();
            
            alert('商品コードが生成されました！下のコードをコピーしてmockData.tsに追加してください。');
        }

        // コピー機能
        function copyCode() {
            const code = document.getElementById('codeOutput').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('コードがクリップボードにコピーされました！');
            });
        }

        // 既存商品表示（例）
        const sampleProducts = [
            {
                title: 'ラクマ掲載商品 - サンプル商品',
                price: 15000,
                originalPrice: 25000,
                brand: 'ラクマブランド',
                featured: true
            }
        ];

        function displayExistingProducts() {
            const container = document.getElementById('existingProducts');
            sampleProducts.forEach(product => {
                const discount = product.originalPrice ? 
                    Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100) : 0;
                
                container.innerHTML += `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h4 class="font-medium text-sm mb-2">${product.title}</h4>
                        <p class="text-lg font-bold text-gray-900">¥${product.price.toLocaleString()}</p>
                        ${product.originalPrice ? `<p class="text-sm text-gray-500 line-through">¥${product.originalPrice.toLocaleString()}</p>` : ''}
                        ${discount > 0 ? `<span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded mt-1">${discount}% OFF</span>` : ''}
                        ${product.featured ? `<span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded mt-1 ml-1">おすすめ</span>` : ''}
                    </div>
                `;
            });
        }

        // ページ読み込み時に既存商品表示
        displayExistingProducts();
    </script>
</body>
</html>